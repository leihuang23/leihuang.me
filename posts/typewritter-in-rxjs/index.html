<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Typewriter Effect With RxJS | Lei's Blog</title>
<meta name=keywords content="rxjs,animation"><meta name=description content="Background
I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t
use a starter template, so I had to make a lot of design decisions. When I wrote
the bio section on the home page, initially I put a long heading there as a
one-sentence introduction. As I was gazing at the screen, I felt something was
wrong. It was too wordy. But after I took out a few words, I was not satisfied
with what was left."><meta name=author content="Lei Huang"><link rel=canonical href=https://leihuang.me/posts/typewritter-in-rxjs/><link crossorigin=anonymous href=/assets/css/stylesheet.4577291afec6711dad0a04c542b24213552d8652dd4306b3ef708f31cd6c229c.css integrity="sha256-RXcpGv7GcR2tCgTFQrJCE1UthlLdQwaz73CPMc1sIpw=" rel="preload stylesheet" as=style><link rel=icon href=https://leihuang.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://leihuang.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://leihuang.me/favicon-32x32.png><link rel=apple-touch-icon href=https://leihuang.me/apple-icon.png><link rel=mask-icon href=https://leihuang.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://leihuang.me/posts/typewritter-in-rxjs/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://leihuang.me/posts/typewritter-in-rxjs/"><meta property="og:site_name" content="Lei's Blog"><meta property="og:title" content="Typewriter Effect With RxJS"><meta property="og:description" content="Background I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t use a starter template, so I had to make a lot of design decisions. When I wrote the bio section on the home page, initially I put a long heading there as a one-sentence introduction. As I was gazing at the screen, I felt something was wrong. It was too wordy. But after I took out a few words, I was not satisfied with what was left."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-30T00:00:00+00:00"><meta property="article:modified_time" content="2020-03-30T00:00:00+00:00"><meta property="article:tag" content="Rxjs"><meta property="article:tag" content="Animation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Typewriter Effect With RxJS"><meta name=twitter:description content="Background
I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t
use a starter template, so I had to make a lot of design decisions. When I wrote
the bio section on the home page, initially I put a long heading there as a
one-sentence introduction. As I was gazing at the screen, I felt something was
wrong. It was too wordy. But after I took out a few words, I was not satisfied
with what was left."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://leihuang.me/posts/"},{"@type":"ListItem","position":2,"name":"Typewriter Effect With RxJS","item":"https://leihuang.me/posts/typewritter-in-rxjs/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Typewriter Effect With RxJS","name":"Typewriter Effect With RxJS","description":"Background I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t use a starter template, so I had to make a lot of design decisions. When I wrote the bio section on the home page, initially I put a long heading there as a one-sentence introduction. As I was gazing at the screen, I felt something was wrong. It was too wordy. But after I took out a few words, I was not satisfied with what was left.\n","keywords":["rxjs","animation"],"articleBody":"Background I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t use a starter template, so I had to make a lot of design decisions. When I wrote the bio section on the home page, initially I put a long heading there as a one-sentence introduction. As I was gazing at the screen, I felt something was wrong. It was too wordy. But after I took out a few words, I was not satisfied with what was left.\nAfter some trying, I came up with an idea. Why not add a typewriter to present more contents with less space? It also adds a lot of fun and dynamic to the page. It seems like legit reasoning, so I did it. I was satisfied at this time.\nA typewriter effect requires dealing with asynchronicity. I can do it in vanilla JavaScript, but the result code would be very complex, with a lot of timer events scattering around. When dealing with complex asynchronous event handling, my rule of thumb is to use tools that help me focus on the desired effects, rather than the housekeeping juggling work. RxJS stands out as my tool of choice for this role.\nWhy RxJS? RxJS enables you to encode time in values. As I see it, the greatest power of RxJS is that it enables you to encode time in values. Time becomes tangible and can be mixed and matched with other values. In the movie Arrival, an alien language can encode time in itself, so the speaker of that language is capable of foreseeing the future. RxJS is similar in a sense. When programming, you’re the dictator of all events, you already knew what will happen before you start. In RxJS, or reactive programming in a broader sense, you can encode future events in a placeholder (I try to avoid ‘variable’ because it may be confusing for beginners) as you declare it.\nThink about the typewriter effect. What we really want is to display different texts on the screen over time. For instance, if we want to type ‘hello’ and then delete it, we want the texts delivered to us over time like this:\n// type h---he---hel---hell---hello // pause -------- // delete hello---hell---hel---he---h // pause -------- We can tell RxJS, “Hey, this is the word, I want you to slice it up like this and give the pieces back to me over time.”\nEncode time in values After we have a clear vision of what we want, let’s do it and write the code!\nStart with the basics. We need to type a single word first. It’s easy.\nconst type = ({word, speed}) =\u003e interval(speed).pipe( map(x =\u003e word.substr(0, x + 1)), take(word.length) ) The interval source will fire up events as per the speed value we provide in milliseconds. Each time it will emit a number increasingly. When the event occurs, we map the emitted value to characters from the word. The interval timer will fire indefinitely, but we only take what we want. After passing the limit specified by the take operator, the timer will stop.\nWe also need a delete effect. Let’s add a parameter ‘backward’ to the type function. We slice differently when ‘backward’ is specified.\nconst type = ({word, speed, backward = false}) =\u003e interval(speed).pipe( map(x =\u003e backward ? word.substr(0, word.length - x - 1) : word.substr(0, x + 1) ), take(word.length) ) To combine the type-pause-delete-pause effects together, we need the concat operator to concatenate 4 event sources (we’ll call them observables from now on)\nconst typeEffect = word =\u003e concat( type({word, speed: 70}), // type of('').pipe(delay(1500), ignoreElements()), // pause type({word, speed: 30, backward: true}), // delete of('').pipe(delay(300), ignoreElements()) // pause ) We type and delete at different speeds. And also pause differently after typing and deleting. For pausing effect, we emit an empty string and delay the event. ignoreElements operator just ignore emmited values. This is to only encode time itself and discard any values.\nThen we move on to type multiple words. Using the from operator, we can turn an array into an observable, which is a term to describe “values over time”. After this, we know RxJS will feed us the items in the array over time. But how frequently? In what form? We’ll tell RxJS in the pursuing operators.\nconst value = useObservable(() =\u003e from(words).pipe(concatMap(typeEffect), repeat()) ) useObservable is a helper function to turn values emitted from observables into React state.\nwe use concatMap to map every word into a new observable and concatenate them. Say we feed RxJS value [‘hello’, ‘how are you’, ‘bye’ ], in a diagram, it will look like this:\n----typeEffect(‘hello’) ----typeEffect(‘how are you’)---typeEffect(‘bye’)--- The repeat operator tells RxJS to repeat the source observable forever.\nThat’s all the code you need to build a typewriter effect!\nHere is a fun demo:\n","wordCount":"803","inLanguage":"en","datePublished":"2020-03-30T00:00:00Z","dateModified":"2020-03-30T00:00:00Z","author":{"@type":"Person","name":"Lei Huang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://leihuang.me/posts/typewritter-in-rxjs/"},"publisher":{"@type":"Organization","name":"Lei's Blog","logo":{"@type":"ImageObject","url":"https://leihuang.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://leihuang.me/ accesskey=h title="Lei's Blog (Alt + H)">Lei's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://leihuang.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://leihuang.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://leihuang.me/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://leihuang.me/>Home</a>&nbsp;»&nbsp;<a href=https://leihuang.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Typewriter Effect With RxJS</h1><div class=post-meta><span title='2020-03-30 00:00:00 +0000 UTC'>March 30, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Lei Huang</div></header><div class=post-content><h2 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h2><p>I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t
use a starter template, so I had to make a lot of design decisions. When I wrote
the bio section on the home page, initially I put a long heading there as a
one-sentence introduction. As I was gazing at the screen, I felt something was
wrong. It was too wordy. But after I took out a few words, I was not satisfied
with what was left.</p><p>After some trying, I came up with an idea. Why not add a typewriter to present
more contents with less space? It also adds a lot of fun and dynamic to the
page. It seems like legit reasoning, so I did it. I was satisfied at this time.</p><p>A typewriter effect requires dealing with asynchronicity. I can do it in vanilla
JavaScript, but the result code would be very complex, with a lot of timer
events scattering around. When dealing with complex asynchronous event handling,
my rule of thumb is to use tools that help me focus on the desired effects,
rather than the housekeeping juggling work. RxJS stands out as my tool of choice
for this role.</p><h2 id=why-rxjs>Why RxJS?<a hidden class=anchor aria-hidden=true href=#why-rxjs>#</a></h2><div class=callout-box><p>RxJS enables you to encode time in values.</p></div><p>As I see it, the greatest power of RxJS is that it enables you to encode time in
values. Time becomes tangible and can be mixed and matched with other values. In
the movie <em>Arrival</em>, an alien language can encode time in itself, so the speaker
of that language is capable of foreseeing the future. RxJS is similar in a
sense. When programming, you’re the dictator of all events, you already knew
what will happen before you start. In RxJS, or reactive programming in a broader
sense, you can encode future events in a placeholder (I try to avoid &lsquo;variable&rsquo;
because it may be confusing for beginners) as you declare it.</p><p>Think about the typewriter effect. What we really want is to display different
texts on the screen over time. For instance, if we want to type ‘hello’ and then
delete it, we want the texts delivered to us over time like this:</p><pre tabindex=0><code>// type
h---he---hel---hell---hello

// pause
--------

// delete
hello---hell---hel---he---h

// pause
--------
</code></pre><p>We can tell RxJS, “Hey, this is the word, I want you to slice it up like this
and give the pieces back to me over time.”</p><h2 id=encode-time-in-values>Encode time in values<a hidden class=anchor aria-hidden=true href=#encode-time-in-values>#</a></h2><p>After we have a clear vision of what we want, let’s do it and write the code!</p><p>Start with the basics. We need to type a single word first. It’s easy.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>type</span> <span class=o>=</span> <span class=p>({</span><span class=nx>word</span><span class=p>,</span> <span class=nx>speed</span><span class=p>})</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>interval</span><span class=p>(</span><span class=nx>speed</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>map</span><span class=p>(</span><span class=nx>x</span> <span class=p>=&gt;</span> <span class=nx>word</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=nx>take</span><span class=p>(</span><span class=nx>word</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span></code></pre></div><p>The <code>interval</code> source will fire up events as per the speed value we provide in
milliseconds. Each time it will emit a number increasingly. When the event
occurs, we map the emitted value to characters from the word. The <code>interval</code>
timer will fire indefinitely, but we only take what we want. After passing the
limit specified by the <code>take</code> operator, the timer will stop.</p><p>We also need a delete effect. Let’s add a parameter ‘backward’ to the <code>type</code>
function. We slice differently when ‘backward’ is specified.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>type</span> <span class=o>=</span> <span class=p>({</span><span class=nx>word</span><span class=p>,</span> <span class=nx>speed</span><span class=p>,</span> <span class=nx>backward</span> <span class=o>=</span> <span class=kc>false</span><span class=p>})</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>interval</span><span class=p>(</span><span class=nx>speed</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>map</span><span class=p>(</span><span class=nx>x</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>backward</span> <span class=o>?</span> <span class=nx>word</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>word</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>x</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>:</span> <span class=nx>word</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>take</span><span class=p>(</span><span class=nx>word</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span></code></pre></div><p>To combine the type-pause-delete-pause effects together, we need the <code>concat</code>
operator to concatenate 4 event sources (we&rsquo;ll call them observables from now
on)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>typeEffect</span> <span class=o>=</span> <span class=nx>word</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>concat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=p>({</span><span class=nx>word</span><span class=p>,</span> <span class=nx>speed</span><span class=o>:</span> <span class=mi>70</span><span class=p>}),</span> <span class=c1>// type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>of</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>1500</span><span class=p>),</span> <span class=nx>ignoreElements</span><span class=p>()),</span> <span class=c1>// pause
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>type</span><span class=p>({</span><span class=nx>word</span><span class=p>,</span> <span class=nx>speed</span><span class=o>:</span> <span class=mi>30</span><span class=p>,</span> <span class=nx>backward</span><span class=o>:</span> <span class=kc>true</span><span class=p>}),</span> <span class=c1>// delete
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>of</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>300</span><span class=p>),</span> <span class=nx>ignoreElements</span><span class=p>())</span> <span class=c1>// pause
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>)</span>
</span></span></code></pre></div><p>We type and delete at different speeds. And also pause differently after typing
and deleting. For pausing effect, we emit an empty string and delay the event.
<code>ignoreElements</code> operator just ignore emmited values. This is to only encode
time itself and discard any values.</p><p>Then we move on to type multiple words. Using the <code>from</code> operator, we can turn
an array into an observable, which is a term to describe &ldquo;values over time&rdquo;.
After this, we know RxJS will feed us the items in the array over time. But how
frequently? In what form? We’ll tell RxJS in the pursuing operators.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>value</span> <span class=o>=</span> <span class=nx>useObservable</span><span class=p>(()</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>from</span><span class=p>(</span><span class=nx>words</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>concatMap</span><span class=p>(</span><span class=nx>typeEffect</span><span class=p>),</span> <span class=nx>repeat</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><p><code>useObservable</code> is a helper function to turn values emitted from observables
into React state.</p><p>we use <code>concatMap</code> to map every word into a new observable and concatenate them.
Say we feed RxJS value <code>[‘hello’, ‘how are you’, ‘bye’ ]</code>, in a diagram, it will
look like this:</p><pre tabindex=0><code>----typeEffect(‘hello’) ----typeEffect(‘how are you’)---typeEffect(‘bye’)---
</code></pre><p>The <code>repeat</code> operator tells RxJS to repeat the source observable forever.</p><p>That&rsquo;s all the code you need to build a typewriter effect!</p><p>Here is a fun demo:</p><iframe src="https://codesandbox.io/embed/youthful-waterfall-0l39l?fontsize=14&hidenavigation=1&theme=dark" style=width:100%;height:500px;border:0;border-radius:4px;overflow:hidden title=khaleesi-typewrier allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe></div><footer class=post-footer><ul class=post-tags><li><a href=https://leihuang.me/tags/rxjs/>Rxjs</a></li><li><a href=https://leihuang.me/tags/animation/>Animation</a></li></ul><nav class=paginav><a class=prev href=https://leihuang.me/posts/time-slicing-with-cps/><span class=title>« Prev</span><br><span>Time-slicing With Continuation-passing Style</span>
</a><a class=next href=https://leihuang.me/posts/implementing-tri/><span class=title>Next »</span><br><span>Implementing A Trie In JavaScript</span></a></nav></footer></article></main><footer class=footer><span>© 2025 Lei Huang</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>