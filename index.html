<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.145.0"><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Lei&#39;s Blog</title>

<meta name="description" content="Lei Huang - Personal Blog of Lei Huang">
<meta name="author" content="Lei Huang">
<link rel="canonical" href="https://leihuang.me/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.db0b65b7349d5fa7f023edb7ef5bca5eb5808a2d8fd960402384d3ea072cd12c.css" integrity="sha256-2wtltzSdX6fwI&#43;2371vKXrWAii2P2WBAI4TT6gcs0Sw=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://leihuang.me/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://leihuang.me/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://leihuang.me/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://leihuang.me/apple-touch-icon.png">
<link rel="mask-icon" href="https://leihuang.me/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://leihuang.me/index.xml">
<link rel="alternate" type="application/json" href="https://leihuang.me/index.json">
<link rel="alternate" hreflang="en" href="https://leihuang.me/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://leihuang.me/">
  <meta property="og:site_name" content="Lei&#39;s Blog">
  <meta property="og:title" content="Lei&#39;s Blog">
  <meta property="og:description" content="Lei Huang - Personal Blog of Lei Huang">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lei&#39;s Blog">
<meta name="twitter:description" content="Lei Huang - Personal Blog of Lei Huang">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Lei's Blog",
  "url": "https://leihuang.me/",
  "description": "Lei Huang - Personal Blog of Lei Huang",
  "logo": "https://leihuang.me/favicon.ico",
  "sameAs": [
      "https://github.com/leihuang23", "https://bsky.app/profile/leihuang.me", "https://www.strava.com/athletes/109784228", "https://notes.leihuang.me"
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://leihuang.me/" accesskey="h" title="Lei&#39;s Blog (Alt + H)">Lei&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://leihuang.me/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://leihuang.me/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://leihuang.me/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<div id="canvas-container">
  <canvas id="canvas1"></canvas>
</div>
<style>
  #canvas1 {
    width: 100%;
    height: auto;
    display: block;
    margin: 0;
    background: #111;
  }
</style>
<script>
  const canvas = document.getElementById("canvas1");
  const ctx = canvas.getContext("2d");
  const canvasContainer = document.getElementById("canvas-container");
  const coordinates = [
    [53, 120],
    [54, 120],
    [55, 120],
    [57, 120],
    [60, 120],
    [65, 120],
    [70, 120],
    [75, 120],
    [80, 121],
    [86, 123],
    [92, 127],
    [97, 132],
    [102, 139],
    [105, 147],
    [108, 158],
    [110, 171],
    [111, 185],
    [111, 199],
    [109, 213],
    [106, 226],
    [101, 237],
    [94, 248],
    [88, 256],
    [82, 262],
    [77, 266],
    [72, 270],
    [67, 271],
    [62, 272],
    [57, 271],
    [53, 268],
    [50, 264],
    [48, 260],
    [47, 255],
    [47, 249],
    [48, 243],
    [51, 237],
    [54, 231],
    [58, 227],
    [63, 223],
    [67, 220],
    [72, 218],
    [78, 216],
    [84, 215],
    [91, 214],
    [98, 214],
    [106, 213],
    [113, 213],
    [119, 212],
    [126, 212],
    [132, 212],
    [138, 210],
    [144, 208],
    [150, 203],
    [154, 198],
    [158, 192],
    [161, 184],
    [163, 175],
    [166, 164],
    [168, 153],
    [170, 142],
    [172, 134],
    [173, 126],
    [173, 121],
    [173, 117],
    [173, 114],
    [173, 113],
    [172, 112],
    [171, 112],
    [169, 113],
    [167, 116],
    [165, 120],
    [163, 125],
    [161, 132],
    [160, 139],
    [158, 147],
    [157, 155],
    [156, 164],
    [156, 173],
    [155, 183],
    [154, 193],
    [154, 203],
    [154, 211],
    [154, 218],
    [154, 224],
    [154, 229],
    [155, 235],
    [156, 240],
    [157, 245],
    [158, 249],
    [160, 253],
    [161, 256],
    [162, 258],
    [163, 261],
    [165, 263],
    [166, 266],
    [168, 268],
    [169, 270],
    [171, 271],
    [172, 272],
    [173, 272],
    [175, 272],
    [178, 271],
    [181, 269],
    [184, 267],
    [188, 264],
    [191, 261],
    [195, 257],
    [199, 252],
    [203, 247],
    [207, 243],
    [210, 238],
    [213, 233],
    [216, 228],
    [218, 223],
    [219, 217],
    [220, 211],
    [220, 206],
    [220, 201],
    [219, 197],
    [217, 194],
    [215, 192],
    [214, 191],
    [212, 191],
    [210, 191],
    [208, 192],
    [205, 194],
    [203, 196],
    [200, 199],
    [198, 201],
    [197, 204],
    [196, 207],
    [196, 211],
    [195, 215],
    [195, 219],
    [196, 224],
    [197, 229],
    [200, 234],
    [202, 239],
    [205, 243],
    [209, 246],
    [212, 248],
    [215, 249],
    [218, 250],
    [221, 251],
    [224, 251],
    [227, 251],
    [231, 251],
    [234, 250],
    [237, 248],
    [240, 246],
    [244, 243],
    [247, 240],
    [250, 235],
    [253, 230],
    [256, 222],
    [259, 213],
    [261, 203],
    [263, 191],
    [264, 179],
    [266, 168],
    [267, 158],
    [268, 150],
    [269, 144],
    [269, 139],
    [269, 136],
    [269, 134],
    [269, 133],
    [269, 134],
    [269, 137],
    [268, 144],
    [267, 152],
    [266, 162],
    [265, 174],
    [264, 188],
    [263, 203],
    [263, 216],
    [263, 226],
    [264, 235],
    [265, 243],
    [266, 250],
    [268, 256],
    [270, 260],
    [271, 263],
    [273, 266],
    [274, 267],
    [276, 269],
    [279, 270],
    [282, 272],
    [284, 273],
    [287, 273],
    [289, 273],
    [291, 271],
    [294, 266],
    [297, 257],
    [300, 245],
    [304, 231],
    [307, 214],
    [310, 196],
    [313, 177],
    [316, 160],
    [318, 145],
    [320, 134],
    [321, 128],
    [322, 124],
    [322, 122],
    [322, 121],
    [322, 121],
    [322, 125],
    [321, 131],
    [319, 139],
    [318, 146],
    [318, 154],
    [317, 162],
    [317, 171],
    [317, 181],
    [317, 190],
    [318, 199],
    [318, 207],
    [319, 214],
    [320, 221],
    [321, 227],
    [323, 233],
    [324, 238],
    [325, 242],
    [326, 245],
    [328, 248],
    [329, 250],
    [331, 251],
    [333, 251],
    [335, 251],
    [338, 251],
    [341, 249],
    [344, 246],
    [348, 242],
    [353, 236],
    [357, 229],
    [362, 220],
    [367, 211],
    [370, 202],
    [373, 194],
    [375, 188],
    [377, 184],
    [378, 182],
    [378, 181],
    [378, 181],
    [376, 181],
    [374, 182],
    [372, 183],
    [369, 185],
    [366, 188],
    [364, 193],
    [362, 198],
    [361, 204],
    [361, 211],
    [361, 217],
    [361, 223],
    [361, 230],
    [362, 235],
    [363, 240],
    [366, 243],
    [369, 246],
    [372, 248],
    [376, 249],
    [379, 249],
    [383, 249],
    [387, 248],
    [392, 246],
    [396, 244],
    [400, 242],
    [405, 239],
    [409, 236],
    [412, 232],
    [416, 228],
    [419, 223],
    [421, 218],
    [422, 213],
    [423, 208],
    [423, 203],
    [423, 198],
    [422, 194],
    [420, 191],
    [418, 189],
    [415, 187],
    [413, 185],
    [411, 184],
    [408, 183],
    [405, 183],
    [402, 182],
    [399, 182],
    [396, 181],
    [393, 181],
    [391, 181],
    [389, 181],
    [387, 181],
    [386, 181],
    [384, 181],
    [383, 181],
    [382, 181],
    [381, 182],
    [380, 183],
    [378, 184],
    [377, 184],
    [376, 185],
    [376, 185],
  ];

  
  let minX = Infinity,
    maxX = -Infinity,
    minY = Infinity,
    maxY = -Infinity;
  coordinates.forEach((pt) => {
    if (pt[0] < minX) minX = pt[0];
    if (pt[0] > maxX) maxX = pt[0];
    if (pt[1] < minY) minY = pt[1];
    if (pt[1] > maxY) maxY = pt[1];
  });

  const designWidth = maxX - minX;
  const designHeight = maxY - minY;
  
  const designCenterX = minX + designWidth / 2;
  const designCenterY = minY + designHeight / 2;

  
  const complexPoints = coordinates.map((pt) => ({
    re: pt[0],
    im: pt[1],
  }));

  
  function dft(x) {
    const N = x.length;
    const X = [];
    for (let k = 0; k < N; k++) {
      let re = 0,
        im = 0;
      for (let n = 0; n < N; n++) {
        const phi = (2 * Math.PI * k * n) / N;
        
        re += x[n].re * Math.cos(phi) + x[n].im * Math.sin(phi);
        im += -x[n].re * Math.sin(phi) + x[n].im * Math.cos(phi);
      }
      re /= N;
      im /= N;
      const freq = k;
      const amp = Math.hypot(re, im);
      const phase = Math.atan2(im, re);
      X.push({ re, im, freq, amp, phase });
    }
    return X;
  }

  
  let fourier = dft(complexPoints);
  fourier.sort((a, b) => b.amp - a.amp);

  
  let time = 0;
  const dt = (2 * Math.PI) / fourier.length; 
  let path = [];
  const animationSpeed = 1; 
  let lastFrameTime = 0;
  let animationFrameId = null; 

  
  function resizeCanvas() {
    
    if (animationFrameId) {
      cancelAnimationFrame(animationFrameId);
    }

    
    
    const newWidth = canvasContainer.clientWidth;

    
    
    
    const newHeight = newWidth * (2 / 3);

    
    canvas.style.width = newWidth + "px";
    canvas.style.height = newHeight + "px";

    
    
    const dpr = window.devicePixelRatio || 1;
    canvas.width = newWidth * dpr;
    canvas.height = newHeight * dpr;

    
    
    ctx.resetTransform(); 
    ctx.scale(dpr, dpr);

    
    path = [];
    time = 0;
    lastFrameTime = 0; 

    
    animationFrameId = requestAnimationFrame(draw);
  }

  
  function draw(currentTime) {
    
    if (lastFrameTime === 0) lastFrameTime = currentTime;
    const elapsed = currentTime - lastFrameTime;

    
    if (elapsed > 1000 / 60 / animationSpeed) {
      lastFrameTime = currentTime; 

      
      const cssWidth = parseFloat(canvas.style.width) || canvas.width;
      const cssHeight = parseFloat(canvas.style.height) || canvas.height;

      
      
      ctx.save();
      ctx.resetTransform(); 
      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.restore(); 

      ctx.save(); 

      
      
      const scaleX = cssWidth / designWidth;
      const scaleY = cssHeight / designHeight;
      
      
      const scale = Math.min(scaleX, scaleY) * 0.9;

      
      ctx.translate(cssWidth / 2, cssHeight / 2);
      
      ctx.scale(scale, scale);
      
      ctx.translate(-designCenterX, -designCenterY);
      

      let x = 0; 
      let y = 0;
      const baseLineWidth = 1; 

      
      for (let i = 0; i < fourier.length; i++) {
        let prevX = x;
        let prevY = y;
        const freq = fourier[i].freq;
        const radius = fourier[i].amp; 
        const phase = fourier[i].phase;
        x += radius * Math.cos(freq * time + phase);
        y += radius * Math.sin(freq * time + phase);

        
        ctx.strokeStyle = "rgba(255, 255, 255, 0.3)";
        
        ctx.lineWidth = baseLineWidth / scale;
        ctx.beginPath();
        ctx.arc(prevX, prevY, radius, 0, 2 * Math.PI);
        ctx.stroke();

        
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = baseLineWidth / scale; 
        ctx.beginPath();
        ctx.moveTo(prevX, prevY);
        ctx.lineTo(x, y);
        ctx.stroke();
      }

      
      path.unshift({ x, y });
      
      if (path.length > 700) {
        
        path.pop();
      }

      
      ctx.beginPath();
      if (path.length > 0) {
        
        ctx.moveTo(path[0].x, path[0].y);
        for (let i = 1; i < path.length; i++) {
          ctx.lineTo(path[i].x, path[i].y);
        }
        ctx.strokeStyle = "#ff4081"; 
        ctx.lineWidth = (baseLineWidth * 2) / scale; 
        ctx.stroke();
      }

      ctx.restore(); 

      
      time += dt;
      if (time >= 2 * Math.PI) {
        time = time % (2 * Math.PI); 
        path = [path[0]]; 
      }
    } 

    
    animationFrameId = requestAnimationFrame(draw);
  }

  
  window.addEventListener("resize", resizeCanvas);

  
  resizeCanvas();
</script>
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Lei Huang</h1>
    </header>
    <div class="entry-content">
        <ul>
<li>is a software engineer based in Berlin.</li>
<li>He loves to write code, run, and wander in the wild.</li>
<li>He speaks English, Chinese, und ein bisschen Deutsch.</li>
</ul>

    </div>
    <footer class="entry-footer">
        <div class="social-icons" >
    <a href="https://github.com/leihuang23" target="_blank" rel="noopener noreferrer me"
        title="I Don&#39;t Usually Write Code After Work">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
    </a>
    <a href="https://bsky.app/profile/leihuang.me" target="_blank" rel="noopener noreferrer me"
        title="Find Me on Bluesky">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="-25 0 400 320" fill="none" stroke="currentColor" stroke-width="30">
    <path
        d="M180 141.964C163.699 110.262 119.308 51.1817 78.0347 22.044C38.4971 -5.86834 23.414 -1.03207 13.526 3.43594C2.08093 8.60755 0 26.1785 0 36.5164C0 46.8542 5.66748 121.272 9.36416 133.694C21.5786 174.738 65.0603 188.607 105.104 184.156C107.151 183.852 109.227 183.572 111.329 183.312C109.267 183.642 107.19 183.924 105.104 184.156C46.4204 192.847 -5.69621 214.233 62.6582 290.33C137.848 368.18 165.705 273.637 180 225.702C194.295 273.637 210.76 364.771 295.995 290.33C360 225.702 313.58 192.85 254.896 184.158C252.81 183.926 250.733 183.645 248.671 183.315C250.773 183.574 252.849 183.855 254.896 184.158C294.94 188.61 338.421 174.74 350.636 133.697C354.333 121.275 360 46.8568 360 36.519C360 26.1811 357.919 8.61012 346.474 3.43851C336.586 -1.02949 321.503 -5.86576 281.965 22.0466C240.692 51.1843 196.301 110.262 180 141.964Z" />
</svg>
    </a>
    <a href="https://www.strava.com/athletes/109784228" target="_blank" rel="noopener noreferrer me"
        title="Find Me on Strava">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke-width="2">
    <path
        d="M15.387 17.944l-2.089-4.116h-3.065L15.387 24l5.15-10.172h-3.066m-7.008-5.599l2.836 5.598h4.172L10.463 0l-7 13.828h4.169" />
</svg>
</svg>
    </a>
    <a href="https://notes.leihuang.me" target="_blank" rel="noopener noreferrer me"
        title="My Notes">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
    </a>
</div>

    </footer>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Learn Batching From LLM
    </h2>
  </header>
  <div class="entry-content">
    <p>
      I was reviewing my old notebook and came across a piece of code that I took from somewhere many years ago. I asked Claude 3.7 Sonnet about this code, and here’s the conversation:
Lei: Take a look at the following code:
let timeout = null; const queue = new Set(); function process() { for (const task of queue) { task(); } queue.clear(); timeout = null; } function enqueue(task) { if (timeout === null) timeout = setTimeout(process, 0); queue.add(task); } I’m not sure how is this code useful. One scenario I can think of is modifying the DOM. Doing DOM manipulation in one batch might avoid reflow. But I’m fuzzy on details. Can you give me a concrete example?
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2025-03-30 15:11:05 +0200 CEST'>March 30, 2025</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Learn Batching From LLM"
    href="https://leihuang.me/posts/learn-batching-from-llm/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Category Mapping with Embedding
    </h2>
  </header>
  <div class="entry-content">
    <p>
      Recently, I faced a daunting task: migrating all of our existing product deals to a brand new, more comprehensive, and standardized set of canonical product categories. This was critical for improving product discoverability, ensuring consistent marketing, and enabling better reporting. Think of it as moving from a somewhat disorganized, ad-hoc filing system to a meticulously organized, hierarchical library catalog.
The problem? Our system had tens of thousands of deals, each with existing category assignments that were often inconsistent, incomplete, or simply didn’t map cleanly to the new structure. Manually re-categorizing everything was out of the question. It would have taken an absurd amount of time and been incredibly prone to errors. I needed an automated solution, but a simple keyword-based approach wouldn’t work. The nuances of product descriptions and the potential mismatches between the old and new categories demanded something far more intelligent.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2023-07-01 00:00:00 +0000 UTC'>July 1, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Category Mapping with Embedding"
    href="https://leihuang.me/posts/category-mapping-with-embedding/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Time-slicing With Coroutine
    </h2>
  </header>
  <div class="entry-content">
    <p>
      I wrote about time-slicing with CPS technique in the last blog post. The solution I proposed has two drawbacks:
The control over task scheduling is too weak. Task slicing relies entirely on hacking the JavaScript engine’s event loop, and it’s impossible to arbitrarily pause and resume. This makes it impossible to precisely time the slices; you can only set them based on subjective experience (the example I provided uses 500 as the interval). However, 500 tasks might still be too long, causing the main thread to be blocked for too long. Or it might be too short, not fully utilizing the current call stack. setTimeout’s timing is inaccurate, and the actual time interval will have deviations. The result is that the delays of each task accumulate, significantly increasing the total task completion time. An alternative solution: Coroutine If a computational task can suspend itself and yield execution to other tasks, it’s a coroutine.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2020-08-15 00:00:00 +0000 UTC'>August 15, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Time-slicing With Coroutine"
    href="https://leihuang.me/posts/time-slicing-with-coroutine/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Time-slicing With Continuation-passing Style
    </h2>
  </header>
  <div class="entry-content">
    <p>
      Background story In January this year, I applied for an overseas dev job. I was asked to finish a project as homework. The project required a ton of computations on the front end, which posed a challenge as I must ensure no operations should block the main thread. I didn’t want to move the computation to a worker thread because the data was consumed in the main thread. Serializing and de-serializing a large set of data also has a performance cost. Furthermore, to improve indexing performance, I used Map to store the results, which is not serializable.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2020-08-06 00:00:00 +0000 UTC'>August 6, 2020</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Time-slicing With Continuation-passing Style"
    href="https://leihuang.me/posts/time-slicing-with-cps/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Typewriter Effect With RxJS
    </h2>
  </header>
  <div class="entry-content">
    <p>
      Background I recently rewrote my blog website from scratch in Gatsby. This time, I didn’t use a starter template, so I had to make a lot of design decisions. When I wrote the bio section on the home page, initially I put a long heading there as a one-sentence introduction. As I was gazing at the screen, I felt something was wrong. It was too wordy. But after I took out a few words, I was not satisfied with what was left.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2020-03-30 00:00:00 +0000 UTC'>March 30, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Typewriter Effect With RxJS"
    href="https://leihuang.me/posts/typewritter-in-rxjs/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Implementing A Trie In JavaScript
    </h2>
  </header>
  <div class="entry-content">
    <p>
      Recently, I encountered a situation where I need to perform text searches in a large set of data. Normally, I would do it in a filter function, but that would be slow when the list is too long. There’s a data structure for this situation. Meet the Trie!
Trie (pronounced try) is a tree-like data structure that’s created for efficient text searches.
How does it work Trie takes all words and rearranges them in a tree hierarchy. For example, the list of words [&#39;abet&#39;, &#39;abode&#39;, &#39;abort&#39;] will be transformed into a structure like this:
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2020-01-04 00:00:00 +0000 UTC'>January 4, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Implementing A Trie In JavaScript"
    href="https://leihuang.me/posts/implementing-tri/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Introduction to Lenses in JavaScript
    </h2>
  </header>
  <div class="entry-content">
    <p>
      When I was reading Eric Elliott&#39;s article on Lenses , I was curious about how such beautiful magic can be fully implemented in JavaScript. It was a tough exploration. Many of the tutorials online are about Haskell, which cannot be easily translated to JavaScript. I read the source code of Ramda and finally grokked how it works.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2019-01-17 00:00:00 +0000 UTC'>January 17, 2019</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Introduction to Lenses in JavaScript"
    href="https://leihuang.me/posts/lens-in-js/"
  ></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Parabolic Curve Animation With RxJS
    </h2>
  </header>
  <div class="entry-content">
    <p>
      I came across this article (written in Chinese) the other day. It was about parabolic curve animation in vanilla JS. I wondered how RxJS can implement this. Below is the result of my investigation.
Imagine we take a perspective from a slow-motion camera. What humans see as a smooth animation is just an object that is put at different places at every fragment of a time period. This can be expressed as a ‘stream’ of object position. The mechanism of an animation can be simplified by somehow mapping every fragment of a time period to a position point in space. In practice, time cannot be fragmented indefinitely, what we want is an approximation of an “atomic time unit”. The browser has provided us a tool to achieve this, which is the requestAnimationFrame API.
...
    </p>
  </div>
  <footer class="entry-footer"><span title='2018-08-02 00:00:00 +0000 UTC'>August 2, 2018</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Lei Huang</footer>
  <a
    class="entry-link"
    aria-label="post link to Parabolic Curve Animation With RxJS"
    href="https://leihuang.me/posts/curve-animation-in-js/"
  ></a>
</article>
    </main>
    
<footer class="footer">
        <span>© 2025 Lei Huang</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
